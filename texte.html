<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pedidos</title>
    <link rel="stylesheet" href="../css/style.css" />
  </head>
  <body>
    <header>
      <div class="header-left">Boteco frango da vivi</div>
      <div class="header-right">
        <span id="quantidadeVendida">0</span>/<span id="quantidadeInput"
          >0</span
        >
      </div>
    </header>
    <div class="container">
      <div class="order">
        <h2>Faça seu pedido</h2>
        <input type="text" id="nome" placeholder="Nome da pessoa" />
        <input type="text" id="endereco" placeholder="Endereço" />
        <label> <input type="checkbox" id="pagamento" /> Já pagou? </label>
        <label>
          <input type="radio" name="retirada" value="loja" /> Retirar na loja
          <input type="radio" name="retirada" value="entrega" /> Entregar
        </label>
        <input type="time" id="horario" />
        <div>
            <label>Frangos (R$55 cada):</label>
            <input type="number" id="quantidadeFrango" min="0" value="0" onchange="atualizarValorTotal()" /><br>
            <label>Maionese (R$15 cada):</label>
            <input type="number" id="quantidadeMaionese" min="0" value="0" onchange="atualizarValorTotal()" /><br>
            <label>Polenta (R$20 cada):</label>
            <input type="number" id="quantidadePolenta" min="0" value="0" onchange="atualizarValorTotal()" />
          </div>
          <p id="valorTotal">Valor Total: R$ 0</p>
        <button class="button2" onclick="finalizarPedido()">
          Finalizar Pedido
        </button>
      </div>
      <div class="pedidos">
        <div id="menu">
          <div id="menu">
            <h3>Pedidos Realizados:</h3>
            <button onclick="filtrarPedidos('todos')">Todos</button>
            <button onclick="filtrarPedidos('pagos')">Pagos</button>
            <button onclick="filtrarPedidos('loja')">Retirar na Loja</button>
            <button onclick="filtrarPedidos('entrega')">Entrega</button>
            <button onclick="finalizarDia()">Dia Finalizado</button>
          </div>
        </div>
        <ul id="listaPedidos"></ul>
      </div>
    </div>

    <script>
 document.addEventListener('DOMContentLoaded', () => {
    // Carrega o total de frangos do localStorage ou define um padrão
    let quantidadeFrangos = parseInt(localStorage.getItem('quantidadeFrangos')) || 22; // Define 22 como padrão
    let quantidadeVendida = parseInt(localStorage.getItem('quantidadeVendida')) || 0;

    // Atualiza os valores no header
    document.getElementById('quantidadeInput').innerText = quantidadeFrangos;
    document.getElementById('quantidadeVendida').innerText = quantidadeVendida;
});
      let pedidos = JSON.parse(localStorage.getItem("pedidos")) || [];

      document.addEventListener("DOMContentLoaded", () => {
        exibirPedidos();
      });

      function atualizarValorTotal() {
    const precoFrango = 55;
    const precoMaionese = 15;
    const precoPolenta = 20;

    const quantidadeFrango = parseInt(document.getElementById('quantidadeFrango').value) || 0;
    const quantidadeMaionese = parseInt(document.getElementById('quantidadeMaionese').value) || 0;
    const quantidadePolenta = parseInt(document.getElementById('quantidadePolenta').value) || 0;

    const total = (quantidadeFrango * precoFrango) +
                  (quantidadeMaionese * precoMaionese) +
                  (quantidadePolenta * precoPolenta);

    document.getElementById('valorTotal').innerText = `Valor Total: R$ ${total}`;
}

      function finalizarPedido() {
    const nome = document.getElementById("nome").value;
    const endereco = document.getElementById("endereco").value;
    const horario = document.getElementById("horario").value;
    const pagamento = document.getElementById("pagamento").checked;
    const retirada = document.querySelector('input[name="retirada"]:checked')?.value;

    const quantidadeFrango = parseInt(document.getElementById('quantidadeFrango').value) || 0;
    const quantidadeMaionese = parseInt(document.getElementById('quantidadeMaionese').value) || 0;
    const quantidadePolenta = parseInt(document.getElementById('quantidadePolenta').value) || 0;

    const precoFrango = 55;
    const precoMaionese = 15;
    const precoPolenta = 20;

    const total = (quantidadeFrango * precoFrango) +
                  (quantidadeMaionese * precoMaionese) +
                  (quantidadePolenta * precoPolenta);

    if (!nome || !retirada) {
        alert("Por favor, preencha o nome e selecione a forma de retirada.");
        return;
    }

    const pedido = {
        nome,
        endereco,
        horario,
        pagamento,
        retirada,
        quantidadeFrango,
        quantidadeMaionese,
        quantidadePolenta,
        total
    };

    pedidos.push(pedido);
    localStorage.setItem("pedidos", JSON.stringify(pedidos));

    document.getElementById("nome").value = "";
    document.getElementById("endereco").value = "";
    document.getElementById("horario").value = "";
    document.getElementById("pagamento").checked = false;
    document.querySelector('input[name="retirada"]:checked').checked = false;
    document.getElementById('quantidadeFrango').value = "0";
    document.getElementById('quantidadeMaionese').value = "0";
    document.getElementById('quantidadePolenta').value = "0";
    document.getElementById('valorTotal').innerText = "Valor Total: R$ 0";

    exibirPedidos();
}
      function exibirPedidos() {
    const listaPedidos = document.getElementById("listaPedidos");
    listaPedidos.innerHTML = "";

    pedidos.forEach((pedido, index) => {
        const li = document.createElement("li");

        li.innerHTML = `
            <div class="separar"> 
                <p>Nome: ${pedido.nome}</p>
                <p>Endereço: ${pedido.endereco}</p>
                <p>Pagamento: ${pedido.pagamento ? "Sim" : "Não"}</p> 
                <p>Retirada: ${pedido.retirada}</p> 
                <p>Horário: ${pedido.horario}</p>  
                <p>Frango: ${pedido.quantidadeFrango} unidade(s)</p> 
                <p>Maionese: ${pedido.quantidadeMaionese} unidade(s)</p> 
                <p>Polenta: ${pedido.quantidadePolenta} unidade(s)</p> 
                <p><strong>Total: R$ ${pedido.total}</strong></p>
            </div>`;

        const cancelarBtn = document.createElement("span");
        cancelarBtn.textContent = "Cancelar";
        cancelarBtn.className = "cancelar";
        cancelarBtn.onclick = () => cancelarPedido(index);

        li.appendChild(cancelarBtn);
        listaPedidos.appendChild(li);
    });
}

      function cancelarPedido(index) {
        if (confirm("Tem certeza que deseja cancelar este pedido?")) {
          pedidos.splice(index, 1);
          localStorage.setItem("pedidos", JSON.stringify(pedidos));
          exibirPedidos();
        }
      }

      function finalizarDia() {
        if (
          confirm(
            "Tem certeza que deseja finalizar o dia? Isso apagará todos os pedidos."
          )
        ) {
          pedidos = [];
          localStorage.setItem("pedidos", JSON.stringify(pedidos));
          exibirPedidos();
          alert("Dia finalizado e pedidos apagados.");
        }
      }

      // Função de filtro para os pedidos
      function filtrarPedidos(filtro) {
        const listaPedidos = document.getElementById("listaPedidos");
        listaPedidos.innerHTML = "";

        const pedidosFiltrados = pedidos.filter((pedido) => {
          if (filtro === "todos") return true;
          if (filtro === "pagos") return pedido.pagamento;
          if (filtro === "loja") return pedido.retirada === "loja";
          if (filtro === "entrega") return pedido.retirada === "entrega";
          return false;
        });

        pedidosFiltrados.forEach((pedido, index) => {
          const li = document.createElement("li");
          li.innerHTML = `
            <div class="separar"> 
                <p>Nome: ${pedido.nome}</p>
                <p>Endereço: ${pedido.endereco}</p>
                <p>Pagamento: ${pedido.pagamento ? "Sim" : "Não"}</p> 
                <p>Retirada: ${pedido.retirada}</p> 
                <p>Horário: ${pedido.horario}</p>  
                <p>Frango: ${pedido.frango ? "Sim" : "Não"}</p> 
                <p>Maionese: ${pedido.maionese ? "Sim" : "Não"}</p> 
                <p>Polenta: ${pedido.polenta ? "Sim" : "Não"}</p> 
            </div>`;

          const cancelarBtn = document.createElement("span");
          cancelarBtn.textContent = "Cancelar";
          cancelarBtn.className = "cancelar";
          cancelarBtn.onclick = () => cancelarPedido(index);

          li.appendChild(cancelarBtn);
          listaPedidos.appendChild(li);
        });
      }
    </script>
  </body>
</html>
